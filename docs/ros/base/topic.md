---
title: 话题通信
---
# {{$frontmatter.title}}

## 概念
ROS 2中的话题通信是基于发布者-订阅者（Publisher-Subscriber）模式进行的。它通过一个称为话题（Topic）的公共媒介来实现不同节点之间的通信。发布者（Publisher）将消息发布到一个特定的话题中，然后订阅者（Subscriber）通过订阅该话题从中接收消息。

::: details 看图说话
![](https://photohosting.oss-cn-hangzhou.aliyuncs.com/captures/ros/topic1.gif)

话题通信的发布方与订阅方是一种多对多的关系，也即，同一话题下可以存在多个发布方，也可以存在多个订阅方，这意味着数据会出现交叉传输的情况，当然如果没有订阅方，数据传输也会出现丢失的情况。

![](https://photohosting.oss-cn-hangzhou.aliyuncs.com/captures/ros/topic2.gif)

:::

具体来说，ROS 2的话题通信流程如下：

1. 创建一个话题（Topic），用于作为消息传递的媒介。发布者和订阅者都需要使用相同的话题名称进行通信。

2. 发布者（Publisher）将消息（Message）发布到指定的话题中。

3. 订阅者（Subscriber）通过订阅指定的话题来接收发布者发布的消息。

4. 消息（Message）传输。当发布者发布这个话题的消息，这个消息将被传输到所有已经订阅该话题的订阅者中，并且他们都将会处理这个消息。

5. 取消订阅。当订阅者不再需要接收某个话题的消息时，它可以取消订阅该话题。

需要注意的是，ROS 2中的话题通信也支持ROS 1中的一些高级功能，如消息过滤、消息压缩等。因此，可以对话题通信进行更多自定义。

## 作用

话题通信一般应用于不断更新的、少逻辑处理的数据传输场景。

## 关于消息接口

关于消息接口的使用有多种方式：

1. 在ROS2中通过std_msgs包封装了一些原生的数据类型,比如：String、Int8、Int16、Int32、Int64、Float32、Float64、Char、Bool、Empty.... 这些原生数据类型也可以作为话题通信的载体，不过这些数据一般只包含一个 data 字段，而std_msgs包中其他的接口文件也比较简单，结构的单一意味着功能上的局限性，当传输一些结构复杂的数据时，就显得力不从心了；
2. 在ROS2中还预定义了许多标准话题消息接口，这在实际工作中有着广泛的应用，比如：sensor_msgs包中定义了许多关于传感器消息的接口（雷达、摄像头、点云......），geometry_msgs包中则定义了许多几何消息相关的接口（坐标点、坐标系、速度指令......）；
3. 如果上述接口文件都不能满足我们的需求，那么就可以自定义接口消息；
